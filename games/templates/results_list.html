{% extends "base.html" %}

{% block content %}

    <div class="column-wrapper">

        <div id="details-column" class="column">

            <div id="page-header">
                LEAGUE RESULTS
            </div>

            {% if results %}

                <!-- For each date when there are results, show the date followed by a list of games. -->
                {% for date in dates %}

                    <div class="sub-header">
                        {{ date|date:"d F Y" }}
                    </div>

                    <table class="stat-table alternating-rows">

                        <tr class="header-row">
                            <th>Away</th>
                            <th>@</th>
                            <th>Home</th>
                        </tr>

                        {% for result in results %}

                            {% if result.game_date == date %}
                                <tr>
                                    <td class="stat-team">
                                        <a class="table-link" href=
                                                "{% url 'team_games' result.away_team.geographic_name|lower %}">
                                            <!-- If the game is complete and the away team won, highlight their name.
                                             -->
                                            {% if result.game_status == "Completed" and result.away_team_runs > result.home_team_runs %}
                                                <strong>{{ result.away_team.geographic_name }}</strong>
                                            {% else %}
                                                {{ result.away_team.geographic_name }}
                                            {% endif %}
                                        </a></td>
                                    <!-- Give a fainter background if the game is not completed. For postponed games,
                                     show 'P-P' instead of the score. -->
                                    {% if result.game_status != "Completed" %}
                                        <td class="stat-detail-faint">
                                            {% if result.game_status == "Postponed" %}
                                                P - P
                                            {% else %}
                                                {{ result.away_team_runs }} - {{ result.home_team_runs }}
                                            {% endif %}
                                        </td>
                                    <!-- Show the score for a completed game. -->
                                    {% else %}
                                        <td class="stat-detail">
                                            <strong>{{ result.away_team_runs }}</strong>
                                            -
                                            <strong>{{ result.home_team_runs }}</strong>
                                        </td>
                                    {% endif %}
                                    <td class="stat-team">
                                        <a class="table-link" href=
                                                "{% url 'team_games' result.home_team.geographic_name|lower %}">
                                            <!-- If the game is complete and the home team won, highlight their name.
                                             -->
                                            {% if result.game_status == "Completed" and result.home_team_runs > result.away_team_runs %}
                                                <strong>{{ result.home_team.geographic_name }}</strong>
                                            {% else %}
                                                {{ result.home_team.geographic_name }}
                                            {% endif %}
                                        </a>
                                    </td>
                                </tr>

                            {% endif %}

                        {% endfor %}

                    </table>

                {% endfor %}

            {% else %}

                No results available for this season.

            {% endif %}

        </div>

        <div id="stats-column" class="column for-desktop">

            <section id="standings">

                <!-- Only include the standings, not the whole statistics sidebar. -->
                <div class="league-box colour-box">
                    STANDINGS
                </div>

                <div class="single-column">

                    {% for conference in conferences %}

                        <div class="spaced-column">

                            <div class="close-header">
                                {{ conference.name }}
                            </div>

                            {% include 'standings.html' %}

                        </div>

                    {% endfor %}

                </div>

            </section>

        </div>

    </div>

{% endblock %}